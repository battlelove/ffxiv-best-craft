{"version":3,"file":"Bom-B9EBSf1C.js","sources":["../../src/components/bom/Item.vue","../../src/components/bom/Selector.vue","../../src/components/bom/Curves.vue","../../src/pages/Bom.vue"],"sourcesContent":["<!-- \n    This file is part of BestCraft.\n    Copyright (C) 2025  Tnze\n\n    BestCraft is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Affero General Public License as published\n    by the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    BestCraft is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Affero General Public License for more details.\n\n    You should have received a copy of the GNU Affero General Public License\n    along with this program.  If not, see <https://www.gnu.org/licenses/>.\n-->\n\n<script setup lang=\"ts\">\nimport {\n    ElText,\n    ElCard,\n    ElInputNumber,\n    ElTooltip,\n    ElBadge,\n} from 'element-plus';\nimport { toRef } from 'vue';\n\nimport { SlotType } from '@/stores/bom';\n\nconst props = defineProps<{\n    id: number;\n    name: string;\n    wasted?: number;\n    requiredInputDisabled?: boolean;\n    holdingInputDisabled?: boolean;\n\n    type?: SlotType;\n}>();\n\nconst requiredNumber = defineModel<number>('requiredNumber', {\n    required: true,\n});\nconst holdingNumber = defineModel<number>('holdingNumber', { required: true });\nconst elemUiTypeMapping = new Map<\n    SlotType | undefined,\n    'warning' | 'success' | 'info' | 'danger' | undefined\n>([\n    [undefined, undefined],\n    ['required', 'danger'],\n    ['crafted', 'warning'],\n    ['completed', 'success'],\n    ['not-required', 'info'],\n]);\n\ndefineExpose({ id: toRef(() => props.id) });\n</script>\n\n<template>\n    <el-card :class=\"type\" :body-class=\"$style.item\" shadow=\"hover\">\n        <el-text :class=\"$style['id-badget']\" size=\"small\" type=\"info\">\n            #{{ id }}\n        </el-text>\n        <el-text :class=\"$style.elem\" :type=\"elemUiTypeMapping.get(type)\">\n            {{ name }}\n        </el-text>\n        <div v-if=\"false\" :class=\"$style.icon\">假装这有图标</div>\n        <el-badge\n            :value=\"wasted ?? 0\"\n            :hidden=\"wasted == undefined || wasted == 0\"\n            type=\"info\"\n        >\n            <el-tooltip\n                :class=\"$style.elem\"\n                :content=\"$t('required-number')\"\n                effect=\"light\"\n                :enterable=\"false\"\n            >\n                <el-input-number\n                    size=\"small\"\n                    v-model=\"requiredNumber\"\n                    step-strictly\n                    :min=\"0\"\n                    :disabled=\"requiredInputDisabled\"\n                    :controls=\"!requiredInputDisabled\"\n                >\n                    <template #suffix>pcs</template>\n                </el-input-number>\n            </el-tooltip>\n        </el-badge>\n        <el-tooltip\n            :class=\"$style.elem\"\n            :content=\"$t('holding-number')\"\n            effect=\"light\"\n            :enterable=\"false\"\n        >\n            <el-input-number\n                :class=\"$style.elem\"\n                size=\"small\"\n                v-model=\"holdingNumber\"\n                step-strictly\n                :min=\"0\"\n                :disabled=\"holdingInputDisabled\"\n            >\n                <template #suffix>pcs</template>\n            </el-input-number>\n        </el-tooltip>\n    </el-card>\n</template>\n\n<style>\n.required {\n    background-color: var(--el-color-danger-light-9);\n    border-color: var(--el-color-danger);\n}\n\n.crafted {\n    background-color: var(--el-color-warning-light-9);\n    border-color: var(--el-color-warning);\n}\n\n.completed {\n    background-color: var(--el-color-success-light-9);\n    border-color: var(--el-color-success);\n}\n\n.not-required {\n    background-color: var(--el-color-info-light-9);\n    /* border-color: var(--el-color-info); */\n}\n</style>\n\n<style module>\n.item {\n    margin: 3px 5px;\n    padding: 0;\n\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.id-badget {\n    flex: auto;\n    align-self: flex-start;\n    margin-bottom: 0;\n    user-select: none;\n}\n\n.elem {\n    margin: 3px;\n}\n\n.icon {\n    margin: 8px;\n    height: 48px;\n    width: 48px;\n    border: 1px solid white;\n    border-radius: 5px;\n    overflow: hidden;\n    user-select: none;\n    color: var(--el-color-info);\n}\n</style>\n\n<fluent locale=\"zh-CN\">\nrequired-number = 需求数量\nholding-number = 持有数量\n</fluent>\n\n<fluent locale=\"zh-TW\">\nrequired-number = 需求數量\nholding-number = 持有數量\n</fluent>\n\n<fluent locale=\"en-US\">\nrequired-number = Required number\nholding-number = Holding number\n</fluent>\n\n<fluent locale=\"ja-JP\">\nrequired-number = 需要数量\nholding-number = 保有数量\n</fluent>\n","<!-- \n    This file is part of BestCraft.\n    Copyright (C) 2025  Tnze\n\n    BestCraft is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Affero General Public License as published\n    by the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    BestCraft is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Affero General Public License for more details.\n\n    You should have received a copy of the GNU Affero General Public License\n    along with this program.  If not, see <https://www.gnu.org/licenses/>.\n-->\n\n<script setup lang=\"ts\">\nimport { ref, useTemplateRef, watch } from 'vue';\nimport {\n    ElTable,\n    ElTableColumn,\n    ElInput,\n    ElSpace,\n    ElButton,\n} from 'element-plus';\nimport type { TableInstance } from 'element-plus';\nimport { Search } from '@element-plus/icons-vue';\n\nimport { Item } from '@/stores/bom';\nimport useSettingStore from '@/stores/settings';\nimport { RecipeInfo } from '@/libs/Craft';\n\nconst emits = defineEmits<{\n    clickItem: [item: Item];\n    selectItems: [items: Item[]];\n}>();\n\nconst settingStore = useSettingStore();\n\nconst search = ref('');\nconst recipeList = ref<RecipeInfo[]>([]);\nconst isLoading = ref(false);\nconst tableInstance = useTemplateRef<TableInstance>('table');\n\nasync function update() {\n    try {\n        isLoading.value = true;\n        const source = await settingStore.getDataSource();\n        const recipeTable = await source.recipeTable(1, search.value);\n        recipeList.value = recipeTable.results;\n    } finally {\n        isLoading.value = false;\n    }\n}\nwatch(search, () => update(), { immediate: true });\n\nconst selected = ref<RecipeInfo[]>([]);\nfunction selectionChanged(rows: RecipeInfo[]) {\n    selected.value = rows;\n}\nfunction selectionConfirmed() {\n    const items = selected.value.map(v => ({\n        id: v.item_id,\n        name: v.item_name,\n    }));\n    emits('selectItems', items);\n    clearSelections();\n}\n\nasync function selectItem(recipe: RecipeInfo) {\n    emits('clickItem', { id: recipe.item_id, name: recipe.item_name });\n    clearSelections();\n}\n\nfunction clearSelections() {\n    selected.value.splice(0);\n    tableInstance.value!.clearSelection();\n}\n</script>\n\n<template>\n    <el-table\n        ref=\"table\"\n        :data=\"recipeList\"\n        @row-click=\"selectItem\"\n        max-height=\"300\"\n        v-tnze-loading=\"isLoading\"\n        @selection-change=\"selectionChanged\"\n    >\n        <el-table-column type=\"selection\" width=\"55\" />\n        <el-table-column prop=\"job\" :label=\"$t('craft-type')\" width=\"150\" />\n        <el-table-column prop=\"item_name\" :label=\"$t('name')\">\n            <template #header>\n                <el-space>\n                    <span>{{ $t('name') }}</span>\n                    <el-input\n                        v-model=\"search\"\n                        size=\"small\"\n                        :placeholder=\"$t('type-to-search')\"\n                        :prefix-icon=\"Search\"\n                        style=\"width: 200px\"\n                    />\n                </el-space>\n            </template>\n        </el-table-column>\n    </el-table>\n    <div class=\"buttons\" v-if=\"selected.length > 0\">\n        <el-button type=\"primary\" @click=\"selectionConfirmed\">\n            {{ $t('confirm') }}\n        </el-button>\n    </div>\n</template>\n\n<style scoped>\n.el-table {\n    user-select: none;\n    border-top-left-radius: var(--tnze-content-raduis);\n    --el-table-header-bg-color: transparent;\n    --el-table-tr-bg-color: transparent;\n}\n\n.buttons {\n    margin-top: 10px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n</style>\n\n<fluent locale=\"zh-CN\">\ncraft-type = 制作类型\nname = 名称\n\ntype-to-search = 输入以搜索\nconfirm = 确认\n</fluent>\n\n<fluent locale=\"zh-TW\">\ncraft-type = 製作職業\nname = 名稱\n\ntype-to-search = 輸入以搜尋\nconfirm = 確認\n</fluent>\n\n<fluent locale=\"en-US\">\ncraft-type = Craft Type\nname = Name\n\ntype-to-search = Type to search\nconfirm = Confirm\n</fluent>\n","<!-- \n    This file is part of BestCraft.\n    Copyright (C) 2025  Tnze\n\n    BestCraft is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Affero General Public License as published\n    by the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    BestCraft is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Affero General Public License for more details.\n\n    You should have received a copy of the GNU Affero General Public License\n    along with this program.  If not, see <https://www.gnu.org/licenses/>.\n-->\n\n<script setup lang=\"ts\">\nimport { useCssVar, UseElementBoundingReturn } from '@vueuse/core';\nimport { h, useTemplateRef } from 'vue';\n\nexport interface Point {\n    x: number;\n    y: number;\n}\n\nexport interface Relation {\n    p1: Point;\n    p2: Point;\n    type?: 'completed' | 'crafted' | 'required' | 'not-required';\n}\n\nconst props = defineProps<{\n    relations: Relation[];\n    clipZone: UseElementBoundingReturn;\n}>();\n\nconst canvas = useTemplateRef('canvas');\nconst palette = new Map([\n    ['required', useCssVar('--el-color-danger', canvas)],\n    ['crafted', useCssVar('--el-color-warning', canvas)],\n    ['completed', useCssVar('--el-color-success', canvas)],\n    ['not-required', useCssVar('--el-color-info', canvas)],\n]);\n\nfunction ingLines(props: { rects: Relation }) {\n    const { p1, p2, type } = props.rects;\n    const d = (p1.y - p2.y) / 2;\n    return h('path', {\n        d: `M ${p1.x} ${p1.y} C ${p1.x} ${p1.y - d} ${p2.x} ${p2.y + d} ${p2.x} ${p2.y}`,\n        stroke: palette.get(type ?? '')?.value ?? 'white',\n        fill: 'transparent',\n    });\n}\n\ndefineExpose({});\n</script>\n\n<template>\n    <div class=\"canvas\" ref=\"canvas\">\n        <svg\n            version=\"1.1\"\n            baseProfile=\"full\"\n            width=\"100%\"\n            height=\"100%\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n        >\n            <defs>\n                <clipPath id=\"cut-off\">\n                    <rect\n                        :x=\"clipZone.x.value\"\n                        :y=\"clipZone.y.value\"\n                        :width=\"clipZone.width.value\"\n                        :height=\"clipZone.height.value\"\n                    />\n                </clipPath>\n            </defs>\n            <g clip-path=\"url(#cut-off)\">\n                <ing-lines v-for=\"v of relations\" :rects=\"v\" />\n            </g>\n        </svg>\n    </div>\n</template>\n\n<style scoped>\n.canvas {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    pointer-events: none;\n\n    /* background-color: rgba(255, 100, 255, 0.5); */\n    /* border: 1px solid blue; */\n    overflow: hidden;\n}\n</style>\n","<!-- \n    This file is part of BestCraft.\n    Copyright (C) 2025  Tnze\n\n    BestCraft is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Affero General Public License as published\n    by the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    BestCraft is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Affero General Public License for more details.\n\n    You should have received a copy of the GNU Affero General Public License\n    along with this program.  If not, see <https://www.gnu.org/licenses/>.\n-->\n\n<script setup lang=\"ts\">\nimport { computed, onActivated, reactive, ref, useTemplateRef } from 'vue';\nimport {\n    ElDivider,\n    ElDialog,\n    ElButton,\n    ElAlert,\n    ElIcon,\n    ElText,\n    ElSwitch,\n    ElScrollbar,\n} from 'element-plus';\nimport { Plus, Delete, Loading, Refresh } from '@element-plus/icons-vue';\nimport { useElementBounding, UseElementBoundingReturn } from '@vueuse/core';\nimport { useFluent } from 'fluent-vue';\n\nimport BomItem from '@/components/bom/Item.vue';\nimport Selector from '@/components/bom/Selector.vue';\nimport Curves, { Relation } from '@/components/bom/Curves.vue';\nimport useStore, { Item, Slot as BomSlot, ItemID } from '@/stores/bom';\n\nconst emit = defineEmits<{\n    (e: 'setTitle', title: string): void;\n}>();\nonActivated(() => emit('setTitle', 'bill-of-material'));\n\nconst { $t } = useFluent();\nconst store = useStore();\nconst selectorOpen = ref(false);\nconst errMsg = ref<string>();\nconst calculating = ref(false);\nconst showRelations = ref(true);\n\ntype BomItemType = InstanceType<typeof BomItem>;\nconst page = useTemplateRef<HTMLDivElement>('page');\nconst targetItems = useTemplateRef<BomItemType[]>('target-items');\nconst ingItems = useTemplateRef<BomItemType[]>('ing-items');\n\nconst pageBound = useElementBounding(page);\n\nconst groupedIngs = computed(() => {\n    if (store.ingredients.length == 0) {\n        return [];\n    }\n    const maxDepth = store.ingredients[store.ingredients.length - 1].depth;\n    const groups: BomSlot[][] = Array.from({ length: maxDepth });\n    for (const ing of store.ingredients) {\n        if (groups[ing.depth] == undefined) groups[ing.depth] = [ing];\n        else groups[ing.depth].push(ing);\n    }\n    return groups.splice(1);\n});\n\nfunction addTarget(...items: Item[]) {\n    selectorOpen.value = false;\n    store.addTarget(...items);\n    updateBom();\n\n    // 当用户添加了较多的目标物品，自动关闭关系线条显示，避免眼花缭乱\n    if (store.targetItems.length > 6) {\n        showRelations.value = false;\n    }\n}\n\nfunction clearTargets() {\n    store.targetItems.splice(0);\n    updateBom();\n}\n\nlet runningProcess: Promise<void> | undefined = undefined;\nasync function updateBom() {\n    let p;\n    try {\n        errMsg.value = undefined;\n        calculating.value = true;\n\n        p = store.updateBom();\n        runningProcess = p;\n        await p;\n\n        // 由于不知为何 vue 提供的 useTemplateRef 不会响应式更新，\n        // 因此在此处手动从 targetItems 和 ingItems 中构造 itemsElems\n        itemsElems.value = new Map(\n            // 当存在重复键值时 new Map() 会用后面的覆盖前面的。\n            // 因此当一个物品同时作为目标与素材时，我们的连线会连在素材上。\n            [targetItems.value, ingItems.value]\n                .filter(v => v != null)\n                .flatMap(items =>\n                    items\n                        .filter(v => v.$el != undefined)\n                        .map(v => [v.id, useElementBounding(v.$el)]),\n                ),\n        );\n    } catch (e: any) {\n        errMsg.value = String(e);\n    } finally {\n        if (p == runningProcess) {\n            runningProcess = undefined;\n            calculating.value = false;\n        }\n    }\n}\n\nconst slots = computed(\n    () => new Map(store.ingredients.map(v => [v.item.id, v])),\n);\nlet itemsElems = ref(new Map<ItemID, UseElementBoundingReturn>());\nlet itemHoverStates = reactive(new Set<ItemID>());\nconst relations = computed(() => {\n    const lines: Relation[] = [];\n    const hoverOnly = !showRelations.value;\n    if (hoverOnly && itemHoverStates.size == 0) return [];\n    for (const [itemId1, elem1] of itemsElems.value) {\n        const slot = slots.value.get(itemId1);\n        if (slot == undefined) continue;\n        for (const [itemId2, amount] of slot.requiredBy) {\n            if (\n                hoverOnly &&\n                !(itemHoverStates.has(itemId1) || itemHoverStates.has(itemId2))\n            )\n                continue;\n            const elem2 = itemsElems.value.get(itemId2);\n            if (elem2 == undefined) continue;\n            lines.push({\n                p1: {\n                    x: elem1.x + elem1.width / 2,\n                    y: elem1.top,\n                },\n                p2: {\n                    x: elem2.x + elem2.width / 2,\n                    y: elem2?.bottom,\n                },\n                type: amount == 0 ? 'not-required' : slot.type,\n            });\n        }\n    }\n    return lines;\n});\n</script>\n\n<template>\n    <el-scrollbar ref=\"page\">\n        <el-dialog v-model=\"selectorOpen\" :title=\"$t('select-recipe')\">\n            <Selector\n                @click-item=\"addTarget\"\n                @select-items=\"v => addTarget(...v)\"\n            />\n        </el-dialog>\n        <div class=\"page\">\n            <TransitionGroup class=\"row\" tag=\"div\">\n                <div class=\"item button-group\" key=\"button-group\">\n                    <el-button\n                        @click=\"selectorOpen = true\"\n                        style=\"width: 100%; flex: auto\"\n                        type=\"primary\"\n                        :icon=\"Plus\"\n                    >\n                        {{ $t('add') }}\n                    </el-button>\n                    <el-button\n                        @click=\"clearTargets\"\n                        style=\"width: 100%; margin: 10px 0 0 0; flex: auto\"\n                        :icon=\"Delete\"\n                    >\n                        {{ $t('clear') }}\n                    </el-button>\n                    <el-switch\n                        v-model=\"showRelations\"\n                        :active-text=\"$t('display-relations')\"\n                    />\n                </div>\n                <BomItem\n                    class=\"item\"\n                    v-for=\"item of store.targetItems\"\n                    ref=\"target-items\"\n                    :id=\"item.item.id\"\n                    :name=\"item.item.name\"\n                    :key=\"item.item.id\"\n                    :required-number=\"item.getFixRequiredNumber()\"\n                    @update:required-number=\"\n                        v => {\n                            item.setFixRequiredNumber(v);\n                            store.updateBom();\n                        }\n                    \"\n                    :holding-number=\"store.holdingItems.get(item.item.id) ?? 0\"\n                    @update:holding-number=\"\n                        v => {\n                            store.holdingItems.set(item.item.id, v);\n                            store.updateBom();\n                        }\n                    \"\n                    :type=\"item.type\"\n                    @mouseenter=\"itemHoverStates.add(item.item.id)\"\n                    @mouseleave=\"itemHoverStates.delete(item.item.id)\"\n                />\n            </TransitionGroup>\n            <el-divider content-position=\"left\">\n                <el-text>\n                    <template v-if=\"calculating\">\n                        <el-text v-if=\"store.fetchingItem\" type=\"info\">\n                            {{\n                                store.fetchingItem != undefined\n                                    ? $t('fetching-item', {\n                                          itemName: store.fetchingItem,\n                                      })\n                                    : $t('calculating')\n                            }}\n                        </el-text>\n                        <el-icon class=\"is-loading\">\n                            <Loading />\n                        </el-icon>\n                    </template>\n                    <template v-else>\n                        {{ $t('ings') }}\n                        <el-button @click=\"updateBom()\" text>\n                            <el-icon>\n                                <Refresh />\n                            </el-icon>\n                        </el-button>\n                    </template>\n                </el-text>\n            </el-divider>\n            <el-alert v-if=\"errMsg\" type=\"error\" show-icon :closable=\"false\">\n                {{ errMsg }}\n            </el-alert>\n            <div v-for=\"group of groupedIngs\" class=\"row ings-row\">\n                <BomItem\n                    class=\"item\"\n                    v-for=\"item of group\"\n                    ref=\"ing-items\"\n                    :key=\"item.item.id\"\n                    :id=\"item.item.id\"\n                    :name=\"item.item.name\"\n                    :wasted=\"item.wasted\"\n                    :required-number=\"item.requiredNumber()\"\n                    requiredInputDisabled\n                    :holding-number=\"store.holdingItems.get(item.item.id) ?? 0\"\n                    @update:holding-number=\"\n                        v => {\n                            store.holdingItems.set(item.item.id, v);\n                            store.updateBom();\n                        }\n                    \"\n                    :type=\"item.type\"\n                    @mouseenter=\"itemHoverStates.add(item.item.id)\"\n                    @mouseleave=\"itemHoverStates.delete(item.item.id)\"\n                />\n            </div>\n            <Curves :relations=\"relations\" :clip-zone=\"pageBound\" />\n        </div>\n    </el-scrollbar>\n</template>\n\n<style scoped>\n.page {\n    padding: 10px;\n}\n\n.row {\n    display: flex;\n    flex-wrap: wrap;\n    padding-bottom: 10px;\n}\n\n.ings-row {\n    padding-bottom: 20px;\n}\n\n.item {\n    flex: none;\n    margin: 5px;\n}\n\n.button-group {\n    height: auto;\n    width: 147px;\n    display: flex;\n    flex-direction: column;\n}\n\n.v-move,\n.v-enter-active,\n.v-leave-active {\n    transition: all 0.5s ease;\n}\n\n.v-enter-from,\n.v-leave-to {\n    opacity: 0;\n    transform: translateX(30px);\n}\n\n.v-leave-active {\n    position: absolute;\n}\n</style>\n\n<style>\n.el-divider__text {\n    background-color: var(--tnze-main-bg-color);\n}\n</style>\n\n<fluent locale=\"zh-CN\">\nings = 材料\ncalculating = 计算中\nfetching-item = 正在查询 { $itemName }\nadd = 添加\nclear = 清空\ndisplay-relations = 显示依赖关系\n</fluent>\n\n<fluent locale=\"en-US\">\nings = Ingredients\ncalculating = Calculating\nfetching-item = Fetching { $itemName }\nadd = Add\nclear = Clear\ndisplay-relations = Display Relations\n</fluent>\n\n<fluent locale=\"ja-JP\">\nings = コンポーネント\ncalculating = ずるい\nfetching-item = つかむ { $itemName }\nadd = 追加\nclear = パージ\ndisplay-relations = 表示関係\n</fluent>\n"],"names":["props","__props","requiredNumber","_useModel","holdingNumber","elemUiTypeMapping","__expose","toRef","_createBlock","_unref","ElCard","$style","_createVNode","ElText","_createTextVNode","_normalizeClass","ElBadge","ElTooltip","$t","ElInputNumber","$event","_cache","emits","__emit","settingStore","useSettingStore","search","ref","recipeList","isLoading","tableInstance","useTemplateRef","update","recipeTable","watch","selected","selectionChanged","rows","selectionConfirmed","items","v","clearSelections","selectItem","recipe","ElTable","ElTableColumn","ElSpace","_createElementVNode","ElInput","Search","_openBlock","_createElementBlock","_hoisted_1","ElButton","canvas","palette","useCssVar","ingLines","p1","p2","type","d","h","_hoisted_2","_hoisted_4","_Fragment","_renderList","emit","onActivated","useFluent","store","useStore","selectorOpen","errMsg","calculating","showRelations","page","targetItems","ingItems","pageBound","useElementBounding","groupedIngs","computed","maxDepth","groups","ing","addTarget","updateBom","clearTargets","runningProcess","p","itemsElems","e","slots","itemHoverStates","reactive","relations","lines","hoverOnly","itemId1","elem1","slot","itemId2","amount","elem2","ElScrollbar","ElDialog","Selector","_TransitionGroup","Plus","Delete","ElSwitch","item","BomItem","ElDivider","ElIcon","Loading","_toDisplayString","Refresh","ElAlert","group","_hoisted_3","Curves"],"mappings":"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"}